.\" t -*- coding: UTF-8 -*-
.\" Manual-Seite f√ºr autofax
.\" Schreiben Sie an geraldschade@gmx.de, wenn Sie Fehler oder M√§ngel entdeckt haben
.pc
.TH man 1 "07.03.17" "Version 0.42781" "Manual-Seite f√ºr autofax"
.SH NAME
\fBautofax\fR \- FaxServer-Funktionalit√§t: veranlasst automatischen Faxversand von Dateien, Benennung empfangener Faxe und Protokollierung aller Faxe in einer Datenbank 
.br
(manpage available in english: 'man autofax' or 'man -Len autofax')
.SH SYNOPSIS
.SY autofax [-<option>]
.OP \-w|--wortreich
.OP \-l|--log
.OP \-ldn|--logdateineu
.OP \-kd|--konfdatei <string>
.OP \-sqlw|--sql-wortreich
.OP \-rf|--rueckfragen
.OP \-norf|--keinerueckfragen
.OP \-loef|--loeschefax
.OP \-loew|--loeschewaise
.OP \-loea|--loescheallew
.OP \-kez|--korrerfolgszeichen
.OP \-bwv|--bereinigewv
.OP \-st|--stop
.OP \-lista|--listausg
.OP \-listf|--listfehlgeschl
.OP \-liste|--listeing
.OP \-listw|--listwartende
.OP \-s|--suche <string>
.OP \-n|--dszahl <zahl>
.OP \-info|--version
.OP \-vi|--vi 
.OP \-h|-help|-?|-hilfe
.OP \-sp|--sprache <d|e>
.OP \-lvz|--logvz <pfad>
.OP \-ld|--logdname <string>
.OP \-zvz|--zufaxenvz <pfad>
.OP \-wvz|--wartevz <pfad>
.OP \-nvz|--nichtgefaxtvz <pfad>
.OP \-evz|--empfvz <pfad>
.OP \-cm|--cronminuten <zahl>
.OP \-capi|--obcapi
.OP \-hyla|--obhyla
.OP \-cz|--capizuerst
.OP \-hz|--hylazuerst
.OP \-mod|--hmodem <string>
.OP \-mc|--maxcapiv <zahl>
.OP \-mh|--maxhylav <zahl>
.OP \-cuser|--cuser <string>
.OP \-ckzl|--capiklingelzahl <zahl>
.OP \-hkzl|--hylaklingelzahl <zahl>
.OP \-hmv|--hmaxwahlvers <zahl>
.OP \-gz|--gleichziel
.OP \-ocre|--ocre
.OP \-ocra|--ocra
.OP \-afs|--anfaxstr <string>
.OP \-acfs|--ancfaxstr <string>
.OP \-ahfs|--anhfaxstr <string>
.OP \-as|--anstr <string>
.OP \-us|--undstr <string>
.OP \-host|--host <string>
.OP \-muser|--muser <string>
.OP \-mpwd|--mpwd <string>
.OP \-db|--datenbank <string>
.SH KURZBESCHREIBUNG
autofax ist ein Befehlszeilenprogramm, mit dem Dateien in einem bestimmten Verzeichnis automatisch an \fBhylafax\fR (falls ein linux-kompatibles Fax-Modem angeschlossen ist) und/oder \fBcapisuite\fR (falls eine Fritzcard 2.0 oder 2.1 angeschlossen ist) weiterleitet werden, wenn die Faxnummer im Dateinamen richtig eingetragen ist,
weiterhin die versandten Faxe in einer MariaDB-Datenbank abspeichert. 
.br
Au√üerdem k√∂nnen von \fBhylafax\fR/\fBcapisuite\fR empfangene Faxe nach dem Sender anhand dessen Faxnummer benannt und abgespeichert werden.
.SH INSTALLATION
.br
Zun√§chst lesen Sie bitte die Kapitel 'Funktionsweise', 'Voraussetzungen' und 'Auswirkungen'. A
.br
Anschlie√üend verbinden Sie den Rechner falls n√∂tig mit dem Internet und rufen Sie auf:
.br
\fBN=autofax;P=${N}_inst.sh;cd ~;wget https://raw.githubusercontent.com/libelle17/$N/master/install.sh -O$P&&sh $P\fR
.br
Zuletzt rufen Sie auf:
.br
 \fBautofax\fR
.br
(einige Rueckfragen des Programms beantworten)
.br
Der erste Programmaufruf und die erste Faxverarbeitung k√∂nnen jeweils etwas dauern und ein paar zus√§tzliche Eingaben erfordern.
.br
Voraussetzungen s.u.
.SH GEBRAUCH
Im Idealfall sollte sich das Programm nach einmaligem Aufruf (s.o.) so eingerichtet haben, dass es von selbst weiter l√§uft.
.br
Es existiert dann ein Verzeichnis z.B. '\fBzufaxen\fR', in das z.B. Benutzer im Netzwerk (z.B. √ºber eine Samba-Freigabe) zu faxende Dateien stellen k√∂nnen wie z.B. 
.br
"\fBArztbericht zu Franz Krank an Dr. Gesund und Franz Krank an Fax 099 987654321 und 088 887654321.doc\fR" (es k√∂nnte auch z.B. eine *.xls, eine *.jpg, eine *.tif, eine *.txt oder eine *.pdf-Datei sein; die Passage 'an Dr. Gesund und Franz Krank ' ist optional f√ºr die sp√§tere Zordnung der Faxnummer(n) in der Datenbank, sie darf auch fehlen).
.br
Wenn \fBautofax\fR beim n√§chsten Mal automatisch aufgerufen wird (standardm√§√üig alle 2 Minuten), wird die o.g. Beispieldatei zun√§chst kopiert und umbenannt in 
.br
"\fBArztbericht zu Franz Krank an Dr. Gesund an Fax 099 987654321.doc\fR" und 
.br
"\fBArztbericht zu Franz Krank an Franz Krank an Fax 088 887654321.doc\fR" und in die PDF-Dateien 
.br
"\fBArztbericht zu Franz Krank an Dr. Gesund an Fax 099 987654321.pdf\fR" und 
.br
"\fBArztbericht zu Franz Krank an Franz Krank an Fax 088 887654321.pdf\fR" umgewandelt.
.br
Diese werden dann automatisch an \fBhylafax\fR oder \fBCapisuite\fR weitergeleitet und von dort aus verschickt.
.br
Gleichzeitig werden sie aus '\fBzufaxen\fR' in das Warteverzeichnis, z.B. '\fBwarteauffax\fR' verschoben und in die Spooltabelle \fBspooltab\fR eingetragen.
.br
Bei jedem Aufruf √ºberpr√ºft autofax den Status von \fBhylafax\fR und/oder \fBCapisuite\fR. Der Abschluss des Faxvorgangs dort hat zur Folge, dass autofax die Quelldateien (also hier die o.g. .doc- und .pdf-Dateien) aus dem Warteverzeichnis in ein oder mehrere alternative Archivverzeichnisse oder ein Verzeichnis f√ºr gescheiteterte Faxe ablegt und den Datenbankeintrag von '\fBspooltab\fR' in die Archivtabelle '\fBouta\fR' verschiebt.
.br
Weiterhin werden √ºber \fBhylafax\fR oder \fBCapisuite\fR angekommene Faxe in ein Empfangsverzeichnis kopiert und ggf. nach dem Sender benannt. Hierzu werden, falls angegeben, konfigurierbare SQL-Befehle verwendet, die in frei festlegbarer Zahl der Reihe nach so lange aufgerufen werden, bis einer einen Datensatz zu der Faxnummer findet.
.br
Der Benutzer k√∂nnte also je nach Betriebssystem, Zugriffsm√∂glichkeit und Pr√§ferenz in den genannten Verzeichnissen, in den Datenbanktabellen oder durch Aufruf von z.B. '\fBautofax\fB', '\fBautofax -lista\fR', '\fBautofax -listf\fR' oder '\fBautofax -listi\fR' den Stand des Faxens √ºberpr√ºfen. 
.SH OPTIONEN 
Mit '\fBautofax -?\fR' werden alle Befehlszeilenoptionen sichtbar. Einige Optionen (z.B. SQL-Befehle) k√∂nnen nicht √ºber die Befehlszeile, sondern nur √ºber die Konfigurationsdatei eingegeben werden, die wiederum direkt editiert oder auch √ºber '\fBautofax -rf\fR' interaktiv gepflegt werden kann.
.br
\fBGebrauch: \fBautofax [-<opt>|--<longopt> [<content>]] ...\fR
.br
\fBOptionen, die nicht gespeichert werden: \fR
.br
\fB -w, --wortreich\fR: Bildschirmausgabe gespraechiger
.br
\fB -l, --log\fR: protokolliert ausfuehrlich in Datei '\fB/var/log/gsautofax.log\fR' (sonst knapper)
.br
\fB -ldn, --logdateineu\fR: logdatei vorher loeschen
.br
\fB -kd, --konfdatei <string>\fR: verwendet Konfigurationsdatei <string> anstatt '\fB/usr/bin/autofax.conf\fR'
.br
\fB -sqlw, --sql-wortreich\fR: Bildschirmausgabe mit SQL-Befehlen
.br
\fB -rf, --rueckfragen\fR: alle Parameter werden abgefragt (darunter einige hier nicht gezeigte)
.br
\fB -krf, --keinerueckfragen\fR: keine Rueckfragen, z.B. aus cron
.br
\fB -loef, --loeschefax\fR: ein Fax nach Rueckfrage loeschen
.br
\fB -loew, --loeschewaise\fR: Eintraege aus `\fBspool\fR` loeschen, zu denen keine Datei im Wartevz.und kein Capi- oder Hylafax nachweisbar ist
.br
\fB -loea, --loescheallew\fR: alle wartenden Faxe und zugehoerige Eintraege aus `\fBspool\fR` loeschen
.br
\fB -kez, --korrerfolgszeichen\fR: in der Datenbanktabelle `\fBouta\fR` wird das Erfolgszeichen korrigiert
.br
\fB -bwv, --bereinigewv\fR: Dateien aus Warteverzeichnis gegen `\fBouta\fR` pruefen und ggf. verschieben
.br
\fB -st, --stop\fR: autofax anhalten
.br
\fB -lista, --listausg\fR: listet Datensaetze aus `\fBouta\fR` mit Erfolgskennzeichen auf
.br
\fB -listf, --listfehlgeschl\fR: listet Datensaetze aus `\fBouta\fR` ohne Erfolgskennzeichen auf
.br
\fB -liste, --listeing\fR: listet Datensaetze aus `\fBinca\fR` auf
.br
\fB -listw, --listwartende\fR: listet wartende Faxe auf
.br
\fB -s, --suche <string>\fR: Suche in verarbeiteten Faxen nach <string>: \fB\fR '\fB\fR'
.br
\fB -n, --dszahl <zahl>\fR: Zahl der aufzulistenden Datensaetze = <zahl> statt '\fB30\fR'
.br
\fB -info, --version\fR: Zeigt die Programmversion an
.br
\fB -vi, --vi\fR: Konfigurationsdatei editieren
.br
\fB -h, --hilfe\fR: Zeigt diesen Bildschirm an
.br
\fBOptionen, die in der Konfigurationsdatei gespeichert werden koennen (vorausgehendes '1'=doch nicht speichern, 'no'=Gegenteil, z.B. '-noocra','-1noocri'):\fR
.br
\fB -sp, --sprache <string>\fR: Language/Sprache/Lingue/Lingua [\fBd\fReutsch,\fBe\fRnglisch] '\fBd\fR'
.br
\fB -lvz, --logvz <pfad>\fR: waehlt als Logverzeichnis <pfad>, derzeit '\fB/var/log\fR'
.br
\fB -ld, --logdname <string>\fR: logdatei <string> (im Pfad '\fB/var/log\fR') wird verwendet anstatt '\fBgsautofax.log\fR'
.br
\fB -zvz, --zufaxenvz <pfad>\fR: faxt die Dateien aus <pfad> anstatt '\fB/vista/P/zufaxen\fR'
.br
\fB -wvz, --wartevz <pfad>\fR: Dateien warten in <pfad> anstatt '\fB/vista/P/warteauffax\fR'
.br
\fB -nvz, --nichtgefaxtvz <pfad>\fR: Gescheiterte Faxe werden hier gesammelt anstatt in '\fB/vista/P/nichtgefaxt\fR'
.br
\fB -evz, --empfvz <pfad>\fR: Empfangsverzeichnis fuer Faxempfang '\fB/vista/P\fR'
.br
\fB -cm, --cronminuten <zahl>\fR: alle wieviel Minuten soll \fBautofax\fR ueber crontab aufgerufen werden (0=gar nicht), anstatt  '\fB0\fR'
.br
\fB -capi, --obcapi\fR: Capisuite verwenden[0;35m oder nicht\fR
.br
\fB -hyla, --obhyla\fR: Hylafax verwenden[0;35m oder nicht\fR
.br
\fB -cz, --capizuerst\fR: versuche faxe zuerst ueber Capisuite wegzuschicken[0;35m oder nicht\fR
.br
\fB -hz, --hylazuerst\fR: versuche faxe zuerst ueber hylafax wegzuschicken[0;35m oder nicht\fR
.br
\fB -mod, --hmodem <string>\fR: Fuer Hylafax verwendetes Modem, anstatt  '\fBttyS1\fR'
.br
\fB -mc, --maxcapiv <zahl>\fR: nach <zahl> Versuchen Capisuite wird Hylafax versucht, anstatt nach '\fB3\fR'
.br
\fB -mh, --maxhylav <zahl>\fR: nach <zahl> Versuchen Hylafax wird Capisuite versucht, anstatt nach '\fB3\fR'
.br
\fB -cuser, --cuser <string>\fR: verwendet fuer Capisuite und/oder Samba den Linux-Benutzer <string> anstatt '\fBschade\fR'
.br
\fB -ckzl, --cklingelzahl <zahl>\fR: Zahl der Klingeltoene, bis Capisuite den Anruf annimmt, anstatt '\fB10\fR'
.br
\fB -hkzl, --hklingelzahl <zahl>\fR: Zahl der Klingeltoene, bis Hylafax den Anruf annimmt, anstatt '\fB2\fR'
.br
\fB -hmw, --hmaxwahlvers <zahl>\fR: Zahl der Wahlversuche in Hylafax, anstatt  '\fB11\fR'
.br
\fB -gz, --gleichziel\fR: Faxe werden auch ohne Faxerfolg ins Zielverzeichnis kopiert[0;35m oder nicht\fR
.br
\fB -ocre, --ocre\fR: Text aus empfangenen Faxen wird ermittelt[0;35m oder nicht\fR
.br
\fB -ocra, --ocra\fR: Text aus gesandten Bildern wird ermittelt[0;35m oder nicht\fR
.br
\fB -afs, --anfaxstr <string>\fR: faxnr wird hinter <string> erwartet statt hinter '\fBan Fax\fR'
.br
\fB -acfs, --ancfaxstr <string>\fR: faxnr fuer primaer Capisuite wird hinter <string> erwartet statt hinter '\fBan cFax\fR'
.br
\fB -ahfs, --anhfaxstr <string>\fR: faxnr fuer primaer hylafax wird hinter <string> erwartet statt hinter '\fBan hFax\fR'
.br
\fB -as, --anstr <string>\fR: Adressatenname wird hinter <string> erwartet statt hinter '\fB an \fR'
.br
\fB -us, --undstr <string>\fR: Trennstring <string> fuer mehrere Adressaten/Telefonnummern statt '\fBund\fR'
.br
\fB -host, --host <string>\fR: verwendet die Datenbank auf Host <string> anstatt auf '\fBlocalhost\fR'
.br
\fB -muser, --muser <string>\fR: verwendet fuer MySQL/MariaDB den Benutzer <string> anstatt '\fBpraxis\fR'
.br
\fB -mpwd, --mpwd <string>\fR: verwendet fuer MySQL/MariaDB das Passwort <string> anstatt '\fBsonne\fR'
.br
\fB -db, --datenbank <string>\fR: verwendet die Datenbank <string> anstatt '\fBfaxeinp\fR'
.br
.SH FUNKTIONSWEISE
.HP 3 
1) Die aktuelle Hardware wird √ºberpr√ºft:
.br
a) mit dem Befehl '\fBlspci | grep -i isdn\fR' bez√ºglich einer ISDN-Karte
.br
b) mit dem Befehl '\fBstty -F\fR' bez√ºglich eines Fax-Modems.
.LP
.HP 3 
2) Die Fax-Konfigurationsdatei \fBfax.conf\fR der Capisuite wird eingelesen, falls es sie gibt
.LP
.HP 3 
3) Weitere Vorgaben aus dem Programmcode werden zugewiesen, die durch die autofax-Konfigurationsdatei (siehe 4), Kommandozeilenargumente oder Antworten auf R√ºckfragen (siehe 5) √ºberdeckt werden k√∂nnen.
.LP
.HP 3 
4) Vorgaben werden geladen aus der Konfigurationsdatei, falls existent (standardm√§√üig \fBautofax.conf\fR im selben Verzeichnis wie \fBautofax\fR, standardm√§√üig \fB/usr/local/sbin/autofax\fR)) 
.LP
.HP 3 
5) R√ºckfragen werden gestellt, falls in der Konfigurationsdatei Werte fehlen oder falls eine Kommandozeilenoption Interaktivit√§t verlangt.
.LP
.HP 3 
6) Das Verzeichnis von \fBhylafax\fR wird ermittelt (\fB/var/spool/hylafax\fR oder \fB/var/spool/fax\fR), falls hylafax installiert ist.
.LP
.HP 3 
7) Von Benutzern verwendete Verzeichnisse f√ºr zu verschickende, wartende, versandte und gescheiterte und empfangene Fax-Dateien werden √ºberpr√ºft und ggf. erstellt. Dabei k√∂nnen in der Konfiguration angegebene Dateinamensmuster ber√ºcksichtigt werden, um erfolgreich versandte Faxe je nach Dateinamen in verschiedenen Verzeichnissen zu speichern.
.LP
.HP 3 
8) Das Programm tr√§gt sich ggf. in \fBcrontab\fR ein, um auf Wunsch in (einstellbaren) Abst√§nden aufgerufen zu werden. Um dies zu verhindern, kann entweder '\fBcronminut\fR' auf \fB0\fR eingestellt werden oder der bereits erstellte autofax-Eintrag mit \fBcrontab -e\fR mit einem vorangestellten '\fB#\fR' auskommentiert werden.
.LP
.HP 3 
9) Das Programm √ºberpr√ºft, ob alle benutzerreleventen Verzeichnisse (s. 7) von Sambafreigaben in \fR/etc/samba/smb.conf\fB erfasst werden, solche werden n√∂tigenfalls erg√§nzt.
.LP
.HP 3 
10) Der Betrieb von MariaDB wird √ºberpr√ºft, ggf. wird es (installiert und) in Betrieb gesetzt, die Datenbanktabellen \fBspooltab\fR (f√ºr gerade laufende Faxe), \fBouta\fR (f√ºr gesandte und gescheiterte Faxe) und \fBinca\fR (f√ºr angekommene Faxe) werden √ºberpr√ºft und ggf. erstellt oder erweitert.
.LP
.HP 3 
11) Im Fall der entsprechenden Kommandozeilenoptionen werden Korrekturen bei Dateien im Warteverzeichnis oder den Protokolltabellen durchgef√ºhrt oder deren Inhalt aufgelistet und das Programm dann beendet.
.LP
.HP 3 
12) Andernfalls werden Dateien im \fBZufaxenverzeichnis\fR analysiert. Jede Datei, deren im Dateinamen enthaltene Faxnummer(n) ermittelbar ist/sind und die in eine PDF-Datei umwandelbar ist (oder schon so vorliegt), wird ins Warteverzeichnis verschoben und in \fBspooltab\fR eingetragen.
.br
Falls eine Datei mehrere Faxnummern enth√§lt und/oder eine PDF-Umwandlung n√∂tig ist, werden zus√§tzliche Dateien erstellt und die urspr√ºngliche Datei ggf. umbenannt.
Falls n√∂tig, k√∂nnen die Dateien zus√§tzliche Zifferm nahe ihrem Namensende bekommen, so dass die Namen mit keinem anderen der unter 7) genannten Verzeichnisse in Konflikt steht.
.br
Falls neue Dateien erstellt wurden, werden die nachfolgenden Verschiebungen und Protokollierungen mit allen durchgef√ºhrt.
.\" DateienHerricht(), WVZinDatenbank()
.LP
.HP 3 
13) Je nach Konfiguration wird die Funktionsf√§higkeit von \fBhylafax\fR und/oder \fBcapisuite\fR √ºberpr√ºft und ggf. versucht herzustellen (falls n√∂tig und m√∂glich auch mit Installation dieser Programme; f√ºr eine Fritzcard 2.0 sowie f√ºr ein Faxmodem USR5637 kann auch eine automatische Konfiguration erfolgen).
.LP
.HP 3 
14) Im Fall entsprechender Kommandozeilenoptionen werden Faxe gel√∂scht und das Programm dann beendet.
.LP
.HP 3 
15) Andernfalls werden die unter 12) in \fBspooltab\fR eingetragenen Dateien an \fBhylafax\fR oder \fBcapisuite\fR weitergeleitet und dies in \fBspooltab\fR protokolliert.
.\" faxealle()
.LP
.HP 3 
16) Alle in \fBspooltab\fR als wartend stehenden Faxe werden in \fBhylafax\fR/\fBcapisuite\fR auf ihren Status √ºberpr√ºft, dieser wird in \fBspooltab\fR aktualisiert (Zahl der bisherigen Faxversuche).
.br
Falls sowohl hylafax als auch capisuite aktiv sind und eine voreingestellte Zahl an Anwahlversuchen im Programm der ersten Pr√§ferenz dieser beiden erfolglos erreicht ist, wird das Fax auch noch an das jeweils andere Programm weitergeleiet.
.br
Falls der Faxvorgang (erfolgreich oder erfolglos) beendet ist, wird die Datei aus dem Warteverzeichnis in die Verzeichnisse f√ºr fertige bzw. gescheiterte Faxe verschoben, optional mit ocrmypdf einer Texterkennung unterzogen, und der Datenbankeintrag aus \fBspooltab\fR in die Tabelle \fBouta\fR verschoben.
.br
Der Status der genannten Faxe wird angezeigt.
.\" untersuchespool()
.LP
.HP 3 
17) Weitere in der Warteschleife von hylafax/capisuite befindliche, nicht √ºber autofax erstellte Faxe werden ggf. angezeigt.
In Intervallen werden sie in die Autofax-Datenbank integriert (ohne die fehlende Information √ºber den urspr√ºnglichen Dateinamen)
.LP
.HP 3 
18) √úber \fBhylafax\fR/\fBcapisuite\fR empfangene Faxe werden ggf. mit Hilfe der Faxnummer anhand voreingestellter SQL-Befehle nach dem Namen des Absenders benannt und in ein Empfangsverzeichnis gestellt.
.br
Solche SQL-Befehle sollen zwei Ergebnisfelder liefern, deren Inhalt dann, durch ein Komma getrennt, zur Benennung eines empfangenen Faxes verwendet werden. Bei der Anwendung des SQL-Befehls wird die Zeichenfolge '&&faxnr&&' zur aktuellen Faxnummer erweitert. Beispiel fuer einen solchen SQL-Befehl:
.br
.br
select concat(haname,', ',ort,', ',kvnu) name, zulg, fax1k from kvaerzte.hae where concat(if(mid(fax1k,1,1)='0','','08131'),                         replace(replace(replace(replace(fax1k,' ',''),'-',''),'/',''),'\'','')) = '&&faxnr&&'
.br
.br
Wenn mehrere SQL-Befehle angegeben werden, so wird der jeweils naechste angewandt, wenn einer kein Ergebnis liefert.
.br
Optional werden die empfangenen Dateien mit Hilfe von ocrmypdf einer Texterkennung unterzogen.
.LP
.HP 3 
19) Die Konfigurationsdatei \fBautofax.conf\fR wird ggf. geschrieben.
.LP

.SH VORAUSSETZUNGEN
Das Programm wurde auf eine Installation von Opensuse >= 42.1, Debian >= 8.60, Ubuntu >= 16.04, Mint >= 18 oder Fedora >= 24 mit den Standardoptionen abgestimmt. System D muss installiert sein bzw. systemctl muss laufen.
.br
Der Computer sollte mit einem linux-kompatiblen Modem oder/und einer Fritzkarte 2.0 oder 2.1 ausgestattet sein. Im Fall von beidem kann das Programm beide Faxwege alternativ nutzen, um die √úbertragungssicherheit zu erh√∂hen.

.SH AUTOMATISCH INSTALLIERTE PROGRAMMPAKETE
.br
(hierzu wird je nach Distribution zypper, apt-get, dnf oder yum verwendet).
\fBmakefile:\fR
.LP
.HP 3
gcc V.6, g++ V.6, groff, libmysqlclient-dev(el), libtiff-dev(el) (im Fall von Vers. 4.0.7 mit leichter Modifikation, s. Makefile)
.br
.br
\fBautofax:\fR
.LP
.HP 3
boost, boost-devel, cron, ghostscript, imagemagick, libreoffice-common, libreoffice-base, mariadb-server, policycoreutils, policycoreutils-python-utils, poppler-tools, samba, sfftobmp, (in debian-derivates, f√ºr mariadb, zus√§tzlich: apt-transport-https)
.br
falls capisuite benutzt werden soll:
.LP
.HP 3
capisuite, capiutils, capi4linux, fcpci-3.10.0, gcc-4.8, g++-4.8, kernel-source (linux-source), libcapi20-2, libcapi20-3, libxslt-tools, linux-headers-$(uname -r), python-devel, (in fedora, zus√§tzlich: kernel, kernel-devel, kernel-modules-extra, numactl-devel, pesign, rpmdevtools; dadurch kann in aktueller kernel installiert werden), 
.br
falls hylafax benutzt werden soll:
.LP
.HP 3
hylafax+, hylafax+-client, sendmail, tiff (im Fall von Vers. 4.0.7 mit leichter Modifikation, s. Makefile)
.br
falls ocr benutzt werden soll:
.LP
.HP 3
ffmpeg, ffmpeg-devel, ffmpeg-compat, gcc, libavformat-devel, libffi-devel, ocrmypdf, python3-devel, python3-pip, python3-setuptools, rpmfusion, qpdf, redhat-rpm-config, tesseract-ocr, unpaper, and via 'python3 pip': cryptography, cffi, image, M2Crypto, ocrmypdf, PyPDF2, reportlab, ruffus.
.br
falls Sie die Quelldateien mit 'sh viall' bearbeiten wollen:
vim
.br
All diese Installationen k√∂nnen abh√§ngige Programme einschlie√üen.
.br
Falls Sie eines dieser Programme nicht wollen bzw. nicht aktualisieren wollen, dann d√ºrfen Sie autofax oder die entsprechenden Programmteile nicht auf diesem Computer verwenden.

.SH AUSWIRKUNGEN DES PROGRAMMABLAUFS
Das Programm muss zum ordentlichen Funktionieren folgende Ma√ünahmen ergreifen:
.LP
.HP 3
1) In Debian kann in der Datei /etc/apt/sources.list ein DVD-Eintrag hinter die Standard-Online-Repositories verschoben werden.
.br
2) Sudo (fehlt anfangs bei Standardinstallation in Debian) wird ggf. installiert. 
.br
Der Benutzer beim Installationsvorgang wird, falls nicht schon enthalten, in eine Administrator-Gruppe eingetragen, die in /etc/sudoers genannt wird), da er "sudo" ausf√ºhren mu√ü.
.br
3) 'GNU make' wird ben√∂tigt, was durch Aufruf von ./install.sh ggf. installiert werden kann.
.LP
.HP 3
4) Installieren von \fBHylafax+\fR, falls ein Modem angeschlossen ist und Hylafax+ nicht installiert ist. Ggf. Konfiguration von Hylafax+ durch Aufruf von '\fBfaxsetup -nointeracitve\fR', durch Editieren der Konfigurationsdateien \fBconfig\fR und \fBconfig.*\fR (z.B. \fBconfig.ttyACM0\fR) im hylafax-Konfigurationsverzeichnis (Vorgabe z.B.: \fB/var/spool/hylafax/etc/\fR)
.LP
.HP 3
5) Installieren von \fBcapisuite\fR, falls eine Fritzkarte eingebaut ist und capisuite nicht installiert ist.
Ggf. Bearbeitung der Konfigurationsdateien \fB/etc/capisuite/capisuite.conf\fR und \fB/etc/capisuite/fax.conf\fR.
Ggf. Bearbeitung des Python-Scripts f√ºr ankommende Faxe (Vorgabe z.B.: \fB/usr/lib64/capisuite/incoming.py\fR) zur Bestimmung der Zahl der Klingelt√∂ne bis zur Faxannahme, Erstellung bzw. Bearbeitung der Dateien '\fB/etc/udev/rules.d/46-FKN_isdn_capi.rules\fR', '\fB/etc/modprobe.d/50-blacklist.conf\fR'.
.LP
.HP 3
6) Einrichten von Diensten: 
.br
a) in systemd (im Verzeichnis /usr/lib/systemd/system oder /lib/systemd/system), insbesondere:
.br
\fBhylafax-faxq.service\fR, \fBhylafax-hfaxd.service\fR, \fBhylafax-faxgetty-....service\fR (z.B. \fBhylafax-faxgetty-ttyACM0\fR),
.br
capisuite.service,
.br
b) Verschieben von Diensten aus dem Verzeichnis /etc/init.d in ein neu eingerichtes Verzeichnis /etc/ausrangiert:
\fBhylafax\fR, \fBcapisuite\fR
.br
c) falls \fBselinux\fR aktiv ist (wie standardm√§√üig in fedora), dann behindert es standardm√§√üig \fBhylafax\fR; in diesem Fall wird im Hintergrund ein Modul f√ºr selinux eingerichtet, um den Betrieb von hylafax-hfaxd wieder zu erlauben. Ferner muss (bis zur eventuellen Erstellung einer ma√ügeschneiderteren L√∂sung) die Dom√§ne 'getty' mit dem Befehl '\fBsemanage permissive -a getty_t\fR' in selinux entsch√§rft werden, um faxe √ºber hylafax empfangen zu k√∂nnen.
.LP
.HP 3
7) Erstellen einer Protokolldatei, standardm√§√üig \fB/var/log/autofax.log\fR.
.LP
.HP 3
8) ggf. Erstellen und Zugreifbarmachen der bestimmbaren \fBVerzeichnisse\fR f√ºr zu sendende, wartende, abgearbeitete und empfangene Faxe.
.LP
.HP 3
9) ggf. Erstellen und Ver√§ndern der Konfigurationsdatei autofax.conf in dem Verzeichnis, in dem auch es selbst steht (Vorgabe: /usr/local/sbin/autofax).
.LP
.HP 3
10) ggf. Einf√ºgen einer Zeile zum Aufruf des Programms in das crontab (von root)
.LP
.HP 3
11) ggf. Einf√ºgen von Abschnitten f√ºr die unter 3) genannten Verzeichnisse in /etc/samba/smb.conf, ggf. Einf√ºgen/Passwortzuteilen des Programmbenutzers bzw. (falls root) des f√ºr die Capisuite gew√§hlten Benutzers als Samba-Bentzer.
.br
Falls Suse-Firewall vorhanden, samba-Server fuer "externe Zone" eintragen.
.LP
.HP 3
12) ggf. Einf√ºgen einer Datenbank f√ºr die Faxe in mariadb unter einem bestimmbaren Namen, Anlage und Ver√§nderung mehrerer Tabellen und einer Prozedur in dieser Datenbank, ggf. Einf√ºgen eines Benutzers mit bestimmbarem Namen in mariadb zur Datenpflege in diesen Tabellen 
.LP
.HP 3
13) durch entsprechende Befehlszeilenoptionen von autofax k√∂nnen innerhalb von hylafax und capisuite Faxe gel√∂scht werden, insbesondere:
.br
a) in hylafax: durch Aufruf von 'faxrm'
.br
b) in capisuite: durch L√∂schen der Dateien wie /var/spool/capisuite/users/<user>/sendq/*.txt und ~/*.sff.
In capisuite kann auch eine verwaiste Lock-Datei (/var/spool/capisuite/users/<user>/sendq/*.lock) gel√∂scht werden.


.SH FEHLER
Fehler bitte mit u.a. dem Wort 'autofax' in der Ueberschrift melden. 
.br
Bitte auch melden, wenn sich √Ñnderungsbedarf durch andere Hard- bzw. Software ergeben.

.SH HAFTUNG
Das Programm wurde mit bester Absicht entwickelt und durch den Autor getestet.
.br
Trotzdem kann der Autor f√ºr keine Sch√§den haften, die durch das Programm entstehen k√∂nnten

.SH AUTOR
Gerald Schade (geraldschade@gmx.de; www.diabdachau.de)
